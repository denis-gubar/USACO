<html>
<head> <title>Wormholes</title> </head>
<body background="/usaco/bg3.jpg">
<img src="/usaco/cow1.jpg" width="742" height="118">
<center>
<b><font size="7">Wormholes</font></b><br>
</center>

<p>Farmer John's hobby of conducting high-energy physics experiments
on weekends has backfired, causing N wormholes (2 <= N <= 12, N
even) to materialize on his farm, each located at a distinct point
on the 2D map of his farm (the x,y coordinates are both integers).

<p>According to his calculations, Farmer John knows that his wormholes
will form N/2 connected pairs. For example, if wormholes A and B
are connected as a pair, then any object entering wormhole A will
exit wormhole B moving in the same direction, and any object entering
wormhole B will similarly exit from wormhole A moving in the same
direction. This can have rather unpleasant consequences.

<p>For example, suppose there are two paired wormholes A at (1,1)
and B at (3,1), and that Bessie the cow starts from position (2,1)
moving in the +x direction. Bessie will enter wormhole B [at (3,1)],
exit from A [at (1,1)], then enter B again, and so on, getting
trapped in an infinite cycle!

<pre>
   | . . . .
   | A > B .      Bessie will travel to B then
   + . . . .      A then across to B again
</pre>

<p>Farmer John knows the exact location of each wormhole on his
farm. He knows that Bessie the cow always walks in the +x direction,
although he does not remember where Bessie is currently located.

<p>Please help Farmer John count the number of distinct pairings
of the wormholes such that Bessie could possibly get trapped in an
infinite cycle if she starts from an unlucky position. FJ doesn't
know which wormhole pairs with any other wormhole, so find all the
possibilities (i.e., all the different ways that N wormholes could
be paired such that Bessie can, in some way, get in a cycle). Note
that a loop with a smaller number of wormholes might contribute a
number of different sets of pairings to the total count as those
wormholes that are not in the loop are paired in many different
ways.

<h3>PROGRAM NAME: wormhole</h3>

<h3>INPUT FORMAT:</h3>

<table border="1">

<tr><td>Line 1:</td><td> The number of wormholes, N.</td></tr>

<tr><td>Lines 2..1+N:</td><td> Each line contains two space-separated
integers describing the (x,y) coordinates of a single wormhole.
Each coordinate is in the range 0..1,000,000,000.  </td></tr>

</table>

<h3>SAMPLE INPUT (file wormhole.in):</he>

<pre>
4
0 0
1 0
1 1
0 1
</pre>

<h3>INPUT DETAILS:</h3>

<p>There are 4 wormholes, forming the corners of a square.

<h3>OUTPUT FORMAT:</h3>

<table>
<tr><td>Line 1:</td><td> The number of distinct pairings of wormholes
such that Bessie could conceivably get stuck in a cycle walking
from some starting point in the +x direction.</td></tr>
</table>

<h3>SAMPLE OUTPUT (file wormhole.out):</h3>
<pre>
2
</pre>

<h3>OUTPUT DETAILS:</h3>

<p>If we number the wormholes 1..4 as we read them from the input,
then if wormhole 1 pairs with wormhole 2 and wormhole 3 pairs with
wormhole 4, Bessie can get stuck if she starts anywhere between
(0,0) and (1,0) or between (0,1) and (1,1).

<pre>
   | . . . .
   4 3 . . .      Bessie will travel to B then
   1-2-.-.-.      A then across to B again
</pre>

<p> Similarly, with the same starting points, Bessie can get stuck
in a cycle if the pairings are 1-3 and 2-4 (if Bessie enters WH#3
and comes out at WH#1, she then walks to WH#2 which transports here
to WH#4 which directs her towards WH#3 again for a cycle).

<p> Only the pairings 1-4 and 2-3 allow Bessie to walk in the +x
direction from any point in the 2D plane with no danger of cycling.
<br>
<div style='width:6.25in;background-color:#FFFFCC;border:1px solid black;'>
<form action="/upload3" enctype="multipart/form-data" method="post"
	style='margin-bottom:0px;'>
<center>
<table>
<tr><td colspan=2><b>Submit a solution:</b></td></tr>
<tr><td style='width:0.75in;'>&nbsp;</td><td>
<input type="file" name="filename">
<input type="submit" VALUE="Send it in!">
<input type="hidden" name="a" value=1yymk9rnt0G>
<input type="hidden" name="S" value=wormhole>
</td></tr>
</table>
</center>
</div>
</form>

<div style='margin-top:1em;width:6.25in;padding:8px;background-color:white;border:1px solid black;'>
<center>
<a href="/usacogate?a=1yymk9rnt0G">Training Gateway</a> &nbsp;| &nbsp;
<a href="mailto:rob.kolstad@gmail.com">Comment or Question </a>
</center>
</div>
</body>
</html>
